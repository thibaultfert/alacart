{% extends 'base.html.twig' %}

{% block title %}{{ product.name }}{% endblock %}

{% block body%}
    <div class="container-fluid" id="one_product_block">
        <article id="one_product_info_part">
            <h2>{{ product.name }}</h2>
            <div class="content">
                <div class="row d-flex justify-content-center">
                    <div class="col-12 col-lg-5">          
                        <div id="carouselControls" class="carousel slide" data-ride="carousel" data-interval="false">
                            <ol class="carousel-indicators">
                                {% for i in 0..(product.numberOfImages - 1) %} {# On boulce de 0 à (nbImage - 1) car le data-slide-to doit commencer à 0 #}
                                    {% if i == 0 %} {# cas particulier : le premier lien doit avoir la class 'active'#}
                                        <li data-target="#carouselControls" data-slide-to="{{ i }}" class="active"></li>
                                    {% else %}
                                        <li data-target="#carouselControls" data-slide-to="{{ i }}"></li>
                                    {% endif %}
                                {% endfor %}
                            </ol>
                            <div class="carousel-inner">
                                {% for i in 1..(product.numberOfImages) %} 
                                    {% if i == 1 %} {# cas particulier : le premier carousel-item doit avoir la class 'active'#}
                                        <div class="carousel-item active">
                                            <img src="{{ asset('images/' ~ product.images ~ i ~ '.jpg') }}" class="img-fluid d-block w-100" alt="Satellite">
                                        </div>                                    
                                    {% else %}
                                        <div class="carousel-item">
                                            <img src="{{ asset('images/' ~ product.images ~ i ~ '.jpg') }}" class="img-fluid d-block w-100" alt="Satellite">
                                        </div>
                                    {% endif %}
                                {% endfor %}
                            </div>
                            <a class="carousel-control-prev" href="#carouselControls" role="button" data-slide="prev">
                                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                                <span class="sr-only">Previous</span>
                            </a>
                            <a class="carousel-control-next" href="#carouselControls" role="button" data-slide="next">
                                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                                <span class="sr-only">Next</span>
                            </a>          
                        </div>        
                    </div>
                    <div class="col-7 d-flex flex-column justify-content-around">
                        <div>{{ product.region }}</div>
                        <div style="font-style: italic">"{{ product.description }}"</div>
                        <div>{{ product.volume }}L</div>
                        <div class="row">
                            <div class="col-6 d-flex align-items-end">{{ product.price }}EUR</div>
                            <div class="col-6">
                                <a href="{{ path('cart_add', {'id' : product.id}) }}" class="btn btn-primary">
                                Ajouter à mon panier
                                </a>
                            </div>     
                        </div>
                        
                    </div>
                </div>
            </div>
        </article>
        <hr>
        <section id="commentaires" class="py-1">
            <h1>Commentaires</h1>
            {% for productComment in product.productComments %}
                <div class="comment">
                    <div class="row">
                        <div class="col-3">
                            {{ productComment.author }} (<small>{{ productComment.createdAt | date ('d/m/Y à H:i') }}</small>)
                        </div> 
                        <div class="col-9">
                            {{ productComment.content }}
                        </div>
                    </div>
                </div>
                <hr>
            {% endfor %}

            {% if app.user %}
            <h1>Ajouter un commentaire</h1>
            {{ form_start(productCommentForm) }}
            {{ form_row(productCommentForm.author, {'label': 'Auteur', 'attr': {'palceholder': 'Votre nom'}})}}
            {{ form_row(productCommentForm.content, {'label': 'Commentaire', 'attr': {'palceholder': 'Votre commentaire'}})}}
            <button class="btn btn-success">Envoyer</button>
            {{ form_end(productCommentForm) }}

            {% else %}
            <h4>Pour laisser un commentaire, merci de vous connecter</h4>
            <a href="{{ path('security_login') }}"><button class="btn btn-secondary">Se connecter</button></a>
            {% endif %}

        </section>
    </div>
{% endblock %}